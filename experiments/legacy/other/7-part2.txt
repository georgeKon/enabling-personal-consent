Query Q(clm,clh) :- NATION(ckg,'INDONESIA',cki,ckj),NATION(ckh,'MOROCCO',ckk,ckl),ORDERS(cke,ckf,ckm,ckn,cko,ckp,ckq,ckr,cks),CUSTOMER(ckf,ckt,cku,ckh,ckv,ckw,ckx,cky),SUPPLIER(ckd,ckz,cla,ckg,clb,clc,cld),LINEITEM(cke,cle,ckd,clf,clg,clh,cli,clj,clk,cll,clm,cln,clo,clp,clq,clr)

SELECT LINEITEM0.L_SHIPDATE, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0 
WHERE NATION1.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND NATION0.N_NAME = 'INDONESIA'
AND NATION1.N_NAME = 'MOROCCO'


Parsing query took 2 miliseconds
Query touches 67503 rows
Planning: 
[23.053, 22.974, 17.142, 24.945, 19.927]
Execution: 
[197686.23, 197087.19, 197183.31, 197140.12, 197271.12]



For constraint Q(me,mi) :- NATION(la,'INDONESIA',lb,lc),NATION(ld,'MOROCCO',le,lf),ORDERS(lg,lh,li,lj,lk,ll,lm,ln,lo),CUSTOMER(lh,lp,lq,ld,lr,ls,lt,lu),SUPPLIER(lv,lw,lx,la,ly,lz,ma),LINEITEM(lg,mb,lv,mc,md,me,mf,mg,'N',mh,mi,mj,mk,ml,mm,mn),PARTSUPP(mb,lv,mo,mp,mq),PART(mb,mr,ms,mt,mu,mv,mw,mx,my)
Constraint has 8 predicates
Constraint targetting 50.7% restrictivity
Constraint touches 34251 rows
Rewriting query with constraint took 0 miliseconds
SELECT LINEITEM0.L_SHIPDATE, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0 
WHERE NATION1.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND NATION0.N_NAME = 'INDONESIA'
AND NATION1.N_NAME = 'MOROCCO'
AND NOT EXISTS(SELECT *
FROM NATION NATION2, NATION NATION3, ORDERS ORDERS1, CUSTOMER CUSTOMER1, SUPPLIER SUPPLIER1, PARTSUPP PARTSUPP0, PART PART0 
WHERE PARTSUPP0.PS_PARTKEY = PART0.P_PARTKEY
AND PARTSUPP0.PS_PARTKEY = LINEITEM0.L_PARTKEY
AND NATION2.N_NATIONKEY = SUPPLIER1.S_NATIONKEY
AND NATION3.N_NATIONKEY = CUSTOMER1.C_NATIONKEY
AND ORDERS1.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS1.O_CUSTKEY = CUSTOMER1.C_CUSTKEY
AND SUPPLIER1.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND SUPPLIER1.S_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND NATION2.N_NAME = 'INDONESIA'
AND NATION3.N_NAME = 'MOROCCO'
AND 'N' = LINEITEM0.L_RETURNFLAG
)

Executing the rewritten query results in 33252 rows.

Planning: 
[71.1, 58.651, 70.538, 70.18, 112.453]
Execution: 
[239325.52, 236662.05, 235092.08, 238671.05, 240836.1]



For constraint Q(od,oh) :- NATION(mz,'INDONESIA',na,nb),NATION(nc,'MOROCCO',nd,ne),ORDERS(nf,ng,nh,ni,nj,nk,nl,nm,nn),CUSTOMER(ng,no,np,nc,nq,nr,ns,nt),SUPPLIER(nu,nv,nw,mz,nx,ny,nz),LINEITEM(nf,oa,nu,ob,oc,od,oe,of,'R',og,oh,oi,oj,ok,ol,om),PARTSUPP(oa,nu,on,oo,op),PART(oa,oq,'Manufacturer#4',or,os,ot,ou,ov,ow)
Constraint has 8 predicates
Constraint targetting 4.92% restrictivity
Constraint touches 3451 rows
Rewriting query with constraint took 1 miliseconds
SELECT LINEITEM0.L_SHIPDATE, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0 
WHERE NATION1.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND NATION0.N_NAME = 'INDONESIA'
AND NATION1.N_NAME = 'MOROCCO'
AND NOT EXISTS(SELECT *
FROM NATION NATION2, NATION NATION3, ORDERS ORDERS1, CUSTOMER CUSTOMER1, SUPPLIER SUPPLIER1, PARTSUPP PARTSUPP0, PART PART0 
WHERE PARTSUPP0.PS_PARTKEY = PART0.P_PARTKEY
AND PARTSUPP0.PS_PARTKEY = LINEITEM0.L_PARTKEY
AND NATION2.N_NATIONKEY = SUPPLIER1.S_NATIONKEY
AND NATION3.N_NATIONKEY = CUSTOMER1.C_NATIONKEY
AND ORDERS1.O_CUSTKEY = CUSTOMER1.C_CUSTKEY
AND ORDERS1.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND SUPPLIER1.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND SUPPLIER1.S_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND NATION2.N_NAME = 'INDONESIA'
AND NATION3.N_NAME = 'MOROCCO'
AND PART0.P_MFGR = 'Manufacturer#4'
AND 'R' = LINEITEM0.L_RETURNFLAG
)

Executing the rewritten query results in 64052 rows.

Planning: 
[65.833, 64.681, 80.258, 77.172, 85.428]
Execution: 
[240519.1, 241559.75, 242584.12, 240261.39, 242591.06]



Running the query against every constraint
Rewriting query with all constraints took 23 miliseconds
For this query, rewriting with all constraints produced 42 successful unifications.
SELECT LINEITEM0.L_SHIPDATE, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0 
WHERE NATION1.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND NATION0.N_NAME = 'INDONESIA'
AND NATION1.N_NAME = 'MOROCCO'
AND (
'N' != LINEITEM0.L_RETURNFLAGOR 'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCT)AND (
4 != LINEITEM0.L_LINENUMBEROR 0.05 != LINEITEM0.L_TAX)AND (
'N' != LINEITEM0.L_RETURNFLAG)AND (
1 != LINEITEM0.L_LINENUMBEROR 0.02 != LINEITEM0.L_TAXOR 'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCT)AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1 
WHERE ORDERS1.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS1.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM1 
WHERE LINEITEM1.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM1.L_RETURNFLAG = 'N'
AND LINEITEM1.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS2, LINEITEM LINEITEM2, CUSTOMER CUSTOMER1 
WHERE CUSTOMER1.C_NATIONKEY = NATION1.N_NATIONKEY
AND ORDERS2.O_ORDERKEY = LINEITEM2.L_ORDERKEY
AND LINEITEM2.L_SHIPMODE = 'FOB'
AND CUSTOMER1.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION1.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER2, ORDERS ORDERS3 
WHERE CUSTOMER2.C_CUSTKEY = ORDERS3.O_CUSTKEY
AND CUSTOMER2.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS3.O_ORDERPRIORITY = '5-LOW'
AND CUSTOMER2.C_MKTSEGMENT = 'AUTOMOBILE'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS4, LINEITEM LINEITEM3 
WHERE ORDERS4.O_ORDERKEY = LINEITEM3.L_ORDERKEY
AND LINEITEM3.L_RETURNFLAG = 'N'
AND LINEITEM3.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM4, CUSTOMER CUSTOMER3, NATION NATION2 
WHERE CUSTOMER3.C_NATIONKEY = NATION2.N_NATIONKEY
AND LINEITEM4.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND NATION2.N_REGIONKEY = 0
AND LINEITEM4.L_SHIPMODE = 'FOB'
AND CUSTOMER3.C_MKTSEGMENT = 'MACHINERY'
)
AND NOT EXISTS(SELECT *
FROM PART PART0, ORDERS ORDERS5 
WHERE ORDERS5.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND PART0.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART0.P_CONTAINER = 'WRAP PKG'
AND PART0.P_MFGR = 'Manufacturer#5'
AND PART0.P_BRAND = 'Brand#54'
AND ORDERS5.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM PART PART1 
WHERE PART1.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART1.P_CONTAINER = 'WRAP PKG'
AND PART1.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM PART PART2, PARTSUPP PARTSUPP0 
WHERE PART2.P_PARTKEY = PARTSUPP0.PS_PARTKEY
AND PART2.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART2.P_CONTAINER = 'WRAP PKG'
AND PART2.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM5, CUSTOMER CUSTOMER4 
WHERE LINEITEM5.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM5.L_RETURNFLAG = 'N'
AND LINEITEM5.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM PART PART3, PARTSUPP PARTSUPP1 
WHERE PART3.P_PARTKEY = PARTSUPP1.PS_PARTKEY
AND PART3.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PARTSUPP1.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PART3.P_BRAND = 'Brand#54'
AND 1 = LINEITEM0.L_LINENUMBER
AND 0.02 = LINEITEM0.L_TAX
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS6, CUSTOMER CUSTOMER5 
WHERE ORDERS6.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM PART PART4 
WHERE PART4.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART4.P_MFGR = 'Manufacturer#4'
AND 6 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS7, CUSTOMER CUSTOMER6, SUPPLIER SUPPLIER1, LINEITEM LINEITEM6, REGION REGION0, PARTSUPP PARTSUPP2, PART PART5 
WHERE CUSTOMER6.C_NATIONKEY = SUPPLIER1.S_NATIONKEY
AND CUSTOMER6.C_NATIONKEY = NATION1.N_NATIONKEY
AND REGION0.R_REGIONKEY = NATION1.N_REGIONKEY
AND ORDERS7.O_ORDERKEY = LINEITEM6.L_ORDERKEY
AND ORDERS7.O_CUSTKEY = CUSTOMER6.C_CUSTKEY
AND SUPPLIER1.S_SUPPKEY = LINEITEM6.L_SUPPKEY
AND SUPPLIER1.S_SUPPKEY = PARTSUPP2.PS_SUPPKEY
AND LINEITEM6.L_PARTKEY = PARTSUPP2.PS_PARTKEY
AND LINEITEM6.L_PARTKEY = PART5.P_PARTKEY
AND ORDERS7.O_ORDERSTATUS = 'F'
AND REGION0.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS8, LINEITEM LINEITEM7, CUSTOMER CUSTOMER7 
WHERE ORDERS8.O_ORDERKEY = LINEITEM7.L_ORDERKEY
AND CUSTOMER7.C_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM7.L_SHIPMODE = 'FOB'
AND CUSTOMER7.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER8, ORDERS ORDERS9 
WHERE CUSTOMER8.C_NATIONKEY = NATION1.N_NATIONKEY
AND CUSTOMER8.C_CUSTKEY = ORDERS9.O_CUSTKEY
AND ORDERS9.O_ORDERPRIORITY = '5-LOW'
AND CUSTOMER8.C_MKTSEGMENT = 'AUTOMOBILE'
)
AND NOT EXISTS(SELECT *
FROM PART PART6, PARTSUPP PARTSUPP3, ORDERS ORDERS10 
WHERE ORDERS10.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND PART6.P_PARTKEY = PARTSUPP3.PS_PARTKEY
AND PART6.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART6.P_CONTAINER = 'WRAP PKG'
AND PART6.P_MFGR = 'Manufacturer#5'
AND PART6.P_BRAND = 'Brand#54'
AND ORDERS10.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS11, CUSTOMER CUSTOMER9 
WHERE ORDERS11.O_CUSTKEY = CUSTOMER9.C_CUSTKEY
AND CUSTOMER9.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS11.O_ORDERSTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER10 
WHERE CUSTOMER10.C_NATIONKEY = NATION0.N_NATIONKEY
AND CUSTOMER10.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM SUPPLIER SUPPLIER2, LINEITEM LINEITEM8, PART PART7 
WHERE SUPPLIER2.S_SUPPKEY = LINEITEM8.L_SUPPKEY
AND LINEITEM8.L_PARTKEY = PART7.P_PARTKEY
AND SUPPLIER2.S_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM8.L_TAX = 0.08
AND PART7.P_MFGR = 'Manufacturer#2'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS12 
WHERE ORDERS12.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS12.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS13 
WHERE ORDERS13.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS13.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM PART PART8 
WHERE PART8.P_PARTKEY = LINEITEM0.L_PARTKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM NATION NATION3, NATION NATION4, ORDERS ORDERS14, CUSTOMER CUSTOMER11, SUPPLIER SUPPLIER3, PARTSUPP PARTSUPP4, PART PART9 
WHERE PARTSUPP4.PS_PARTKEY = PART9.P_PARTKEY
AND PARTSUPP4.PS_PARTKEY = LINEITEM0.L_PARTKEY
AND NATION3.N_NATIONKEY = SUPPLIER3.S_NATIONKEY
AND NATION4.N_NATIONKEY = CUSTOMER11.C_NATIONKEY
AND ORDERS14.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS14.O_CUSTKEY = CUSTOMER11.C_CUSTKEY
AND SUPPLIER3.S_SUPPKEY = PARTSUPP4.PS_SUPPKEY
AND SUPPLIER3.S_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND NATION3.N_NAME = 'INDONESIA'
AND NATION4.N_NAME = 'MOROCCO'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS15, CUSTOMER CUSTOMER12 
WHERE CUSTOMER12.C_NATIONKEY = NATION1.N_NATIONKEY
AND ORDERS15.O_CUSTKEY = CUSTOMER12.C_CUSTKEY
AND ORDERS15.O_ORDERSTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM PART PART10, PARTSUPP PARTSUPP5 
WHERE PART10.P_PARTKEY = PARTSUPP5.PS_PARTKEY
AND PART10.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PARTSUPP5.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PART10.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS16, CUSTOMER CUSTOMER13, SUPPLIER SUPPLIER4, LINEITEM LINEITEM9, REGION REGION1, PARTSUPP PARTSUPP6, PART PART11 
WHERE REGION1.R_REGIONKEY = NATION0.N_REGIONKEY
AND ORDERS16.O_ORDERKEY = LINEITEM9.L_ORDERKEY
AND ORDERS16.O_CUSTKEY = CUSTOMER13.C_CUSTKEY
AND SUPPLIER4.S_SUPPKEY = LINEITEM9.L_SUPPKEY
AND SUPPLIER4.S_SUPPKEY = PARTSUPP6.PS_SUPPKEY
AND LINEITEM9.L_PARTKEY = PARTSUPP6.PS_PARTKEY
AND LINEITEM9.L_PARTKEY = PART11.P_PARTKEY
AND CUSTOMER13.C_NATIONKEY = SUPPLIER4.S_NATIONKEY
AND CUSTOMER13.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS16.O_ORDERSTATUS = 'F'
AND REGION1.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS17 
WHERE ORDERS17.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS17.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM SUPPLIER SUPPLIER5, LINEITEM LINEITEM10, PART PART12 
WHERE SUPPLIER5.S_NATIONKEY = NATION1.N_NATIONKEY
AND SUPPLIER5.S_SUPPKEY = LINEITEM10.L_SUPPKEY
AND LINEITEM10.L_PARTKEY = PART12.P_PARTKEY
AND LINEITEM10.L_TAX = 0.08
AND PART12.P_MFGR = 'Manufacturer#2'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER14 
WHERE CUSTOMER14.C_NATIONKEY = NATION1.N_NATIONKEY
AND CUSTOMER14.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION1.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS18, CUSTOMER CUSTOMER15, SUPPLIER SUPPLIER6, LINEITEM LINEITEM11, REGION REGION2, PARTSUPP PARTSUPP7, PART PART13 
WHERE REGION2.R_REGIONKEY = NATION0.N_REGIONKEY
AND ORDERS18.O_ORDERKEY = LINEITEM11.L_ORDERKEY
AND ORDERS18.O_CUSTKEY = CUSTOMER15.C_CUSTKEY
AND SUPPLIER6.S_SUPPKEY = LINEITEM11.L_SUPPKEY
AND SUPPLIER6.S_SUPPKEY = PARTSUPP7.PS_SUPPKEY
AND LINEITEM11.L_PARTKEY = PARTSUPP7.PS_PARTKEY
AND LINEITEM11.L_PARTKEY = PART13.P_PARTKEY
AND CUSTOMER15.C_NATIONKEY = SUPPLIER6.S_NATIONKEY
AND CUSTOMER15.C_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM11.L_TAX = 0.08
AND PART13.P_MFGR = 'Manufacturer#2'
AND REGION2.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION5, NATION NATION6, ORDERS ORDERS19, CUSTOMER CUSTOMER16, SUPPLIER SUPPLIER7, PARTSUPP PARTSUPP8, PART PART14 
WHERE PARTSUPP8.PS_PARTKEY = PART14.P_PARTKEY
AND PARTSUPP8.PS_PARTKEY = LINEITEM0.L_PARTKEY
AND NATION5.N_NATIONKEY = SUPPLIER7.S_NATIONKEY
AND NATION6.N_NATIONKEY = CUSTOMER16.C_NATIONKEY
AND ORDERS19.O_CUSTKEY = CUSTOMER16.C_CUSTKEY
AND ORDERS19.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND SUPPLIER7.S_SUPPKEY = PARTSUPP8.PS_SUPPKEY
AND SUPPLIER7.S_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND NATION5.N_NAME = 'INDONESIA'
AND NATION6.N_NAME = 'MOROCCO'
AND PART14.P_MFGR = 'Manufacturer#4'
AND 'R' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM PART PART15 
WHERE PART15.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART15.P_MFGR = 'Manufacturer#4'
AND 'R' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS20, CUSTOMER CUSTOMER17, SUPPLIER SUPPLIER8, LINEITEM LINEITEM12, REGION REGION3, PARTSUPP PARTSUPP9, PART PART16 
WHERE ORDERS20.O_ORDERKEY = LINEITEM12.L_ORDERKEY
AND CUSTOMER17.C_NATIONKEY = SUPPLIER8.S_NATIONKEY
AND CUSTOMER17.C_NATIONKEY = NATION1.N_NATIONKEY
AND ORDERS20.O_CUSTKEY = CUSTOMER17.C_CUSTKEY
AND REGION3.R_REGIONKEY = NATION1.N_REGIONKEY
AND SUPPLIER8.S_SUPPKEY = LINEITEM12.L_SUPPKEY
AND SUPPLIER8.S_SUPPKEY = PARTSUPP9.PS_SUPPKEY
AND LINEITEM12.L_PARTKEY = PARTSUPP9.PS_PARTKEY
AND LINEITEM12.L_PARTKEY = PART16.P_PARTKEY
AND LINEITEM12.L_TAX = 0.08
AND PART16.P_MFGR = 'Manufacturer#2'
AND REGION3.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION7 
WHERE NATION7.N_NATIONKEY = NATION1.N_NATIONKEY
AND NATION7.N_REGIONKEY = 0
AND 'MACHINERY' = CUSTOMER0.C_MKTSEGMENT
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS21, CUSTOMER CUSTOMER18, NATION NATION8 
WHERE CUSTOMER18.C_NATIONKEY = NATION8.N_NATIONKEY
AND ORDERS21.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND NATION8.N_REGIONKEY = 0
AND CUSTOMER18.C_MKTSEGMENT = 'MACHINERY'
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS22, LINEITEM LINEITEM13, NATION NATION9 
WHERE NATION9.N_NATIONKEY = NATION1.N_NATIONKEY
AND ORDERS22.O_ORDERKEY = LINEITEM13.L_ORDERKEY
AND NATION9.N_REGIONKEY = 0
AND LINEITEM13.L_SHIPMODE = 'FOB'
AND 'MACHINERY' = CUSTOMER0.C_MKTSEGMENT
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS23 
WHERE ORDERS23.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)

Executing the rewritten query results in -1 rows.

Planning: 
[0.0, 0.0, 0.0, 0.0, 0.0]
Execution: 
[0.0, 0.0, 0.0, 0.0, 0.0]



