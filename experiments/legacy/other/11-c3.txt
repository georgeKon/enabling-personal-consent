For constraint Q(amo) :- PARTSUPP(amo,amp,amq,amr,ams),NATION(amt,'JAPAN',amu,amv),SUPPLIER(amp,amw,amx,amt,amy,amz,ana),CUSTOMER(anb,anc,and,amt,ane,anf,ang,anh),ORDERS(ani,anb,'O',anj,ank,anl,anm,ann,ano)
Constraint has 5 predicates
Constraint targetting 48.8% restrictivity
Constraint touches -1 rows
Rewriting query with constraint took 14029095 miliseconds
SELECT PARTSUPP0.PS_PARTKEY 
FROM PARTSUPP PARTSUPP0, NATION NATION0, SUPPLIER SUPPLIER0 
WHERE NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PARTSUPP0.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND NATION0.N_NAME = 'JAPAN'
AND NOT EXISTS(SELECT *
FROM NATION NATION1, SUPPLIER SUPPLIER1, CUSTOMER CUSTOMER0, ORDERS ORDERS0 
WHERE NATION1.N_NATIONKEY = SUPPLIER1.S_NATIONKEY
AND NATION1.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND CUSTOMER0.C_CUSTKEY = ORDERS0.O_CUSTKEY
AND SUPPLIER1.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND NATION1.N_NAME = 'JAPAN'
AND ORDERS0.O_ORDERSTATUS = 'O'
)

Executing the rewritten query results in 0 rows.

Planning: 
[13.541, 17.994, 13.738, 14.795, 16.604]
Execution: 
[794047.2, 753884.4, 775141.9, 734858.25, 765502.3]



