Query Q(cgg,cfx,cgi,cgh,cgk,cgj,cga,cfq) :- PARTSUPP(cfq,cfr,cfu,cfv,cfw),NATION(cfs,cfx,cft,cfy),PART(cfq,cfz,cga,cgb,cgc,9,cgd,cge,cgf),SUPPLIER(cfr,cgg,cgh,cfs,cgi,cgj,cgk),REGION(cft,'MIDDLE EAST',cgl)

SELECT SUPPLIER0.S_NAME, NATION0.N_NAME, SUPPLIER0.S_PHONE, SUPPLIER0.S_ADDRESS, SUPPLIER0.S_COMMENT, SUPPLIER0.S_ACCTBAL, PART0.P_MFGR, PARTSUPP0.PS_PARTKEY 
FROM PARTSUPP PARTSUPP0, NATION NATION0, PART PART0, SUPPLIER SUPPLIER0, REGION REGION0 
WHERE PARTSUPP0.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PARTSUPP0.PS_PARTKEY = PART0.P_PARTKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_SIZE = 9
AND REGION0.R_NAME = 'MIDDLE EAST'


Parsing query took 8 miliseconds
Query touches 22437 rows
Planning: 
[15.271, 15.082, 16.46, 17.612, 21.671]
Execution: 
[29495.154, 29491.389, 29478.062, 29484.846, 29496.668]



For constraint Q(zj,yy,zk,zl,zm,zc,ys,zi) :- PARTSUPP(ys,yt,yu,yv,yw),NATION(yx,yy,yz,za),PART(ys,zb,zc,zd,ze,9,zf,zg,zh),SUPPLIER(yt,zi,zj,yx,zk,zl,zm),REGION(yz,'MIDDLE EAST',zn),LINEITEM(zo,ys,yt,zp,zq,zr,zs,zt,zu,'O',zv,zw,zx,zy,zz,aaa),CUSTOMER(aab,aac,aad,yx,aae,aaf,aag,zu)
Constraint has 7 predicates
Constraint targetting 50.1% restrictivity
Constraint touches 0 rows
Rewriting query with constraint took 3 miliseconds
SELECT SUPPLIER0.S_NAME, NATION0.N_NAME, SUPPLIER0.S_PHONE, SUPPLIER0.S_ADDRESS, SUPPLIER0.S_COMMENT, SUPPLIER0.S_ACCTBAL, PART0.P_MFGR, PARTSUPP0.PS_PARTKEY 
FROM PARTSUPP PARTSUPP0, NATION NATION0, PART PART0, SUPPLIER SUPPLIER0, REGION REGION0 
WHERE PARTSUPP0.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PARTSUPP0.PS_PARTKEY = PART0.P_PARTKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_SIZE = 9
AND REGION0.R_NAME = 'MIDDLE EAST'

Executing the rewritten query results in 22437 rows.

Planning: 
[17.073, 16.42, 16.734, 20.172, 20.001]
Execution: 
[29485.08, 29485.865, 29484.986, 29467.031, 29481.738]



For constraint Q(abb,aba,aar,aay,aax,aah,aaz,aan) :- PARTSUPP(aah,aai,aaj,aak,aal),NATION(aam,aan,aao,aap),PART(aah,aaq,aar,aas,aat,9,aau,aav,aaw),SUPPLIER(aai,aax,aay,aam,aaz,aba,abb),REGION(aao,'MIDDLE EAST',abc),CUSTOMER(abd,abe,abf,aam,abg,abh,'AUTOMOBILE',abi),ORDERS(abj,abd,abk,abl,abm,'5-LOW',abn,abo,abp)
Constraint has 7 predicates
Constraint targetting 4% restrictivity
Constraint touches 378724834 rows
Rewriting query with constraint took 2 miliseconds
SELECT SUPPLIER0.S_NAME, NATION0.N_NAME, SUPPLIER0.S_PHONE, SUPPLIER0.S_ADDRESS, SUPPLIER0.S_COMMENT, SUPPLIER0.S_ACCTBAL, PART0.P_MFGR, PARTSUPP0.PS_PARTKEY 
FROM PARTSUPP PARTSUPP0, NATION NATION0, PART PART0, SUPPLIER SUPPLIER0, REGION REGION0 
WHERE PARTSUPP0.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PARTSUPP0.PS_PARTKEY = PART0.P_PARTKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_SIZE = 9
AND REGION0.R_NAME = 'MIDDLE EAST'

Executing the rewritten query results in 22437 rows.

Planning: 
[20.557, 15.539, 14.774, 13.323, 25.99]
Execution: 
[29482.908, 29459.61, 29489.574, 29491.912, 29478.658]



Running the query against every constraint
Rewriting query with all constraints took 43 miliseconds
For this query, rewriting with all constraints produced 22 successful unifications.
SELECT SUPPLIER0.S_NAME, NATION0.N_NAME, SUPPLIER0.S_PHONE, SUPPLIER0.S_ADDRESS, SUPPLIER0.S_COMMENT, SUPPLIER0.S_ACCTBAL, PART0.P_MFGR, PARTSUPP0.PS_PARTKEY 
FROM PARTSUPP PARTSUPP0, NATION NATION0, PART PART0, SUPPLIER SUPPLIER0, REGION REGION0 
WHERE PARTSUPP0.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PARTSUPP0.PS_PARTKEY = PART0.P_PARTKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_SIZE = 9
AND REGION0.R_NAME = 'MIDDLE EAST'
AND NOT EXISTS(SELECT *
FROM NATION NATION1, CUSTOMER CUSTOMER0 
WHERE NATION1.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION1.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION1.N_NAME = 'ARGENTINA'
AND CUSTOMER0.C_MKTSEGMENT = 'FURNITURE'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION2, ORDERS ORDERS0, LINEITEM LINEITEM0, CUSTOMER CUSTOMER1, REGION REGION1 
WHERE NATION2.N_REGIONKEY = REGION1.R_REGIONKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER1.C_CUSTKEY
AND LINEITEM0.L_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND NATION2.N_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM0.L_RETURNFLAG = 'N'
AND ORDERS0.O_ORDERSTATUS = 'F'
AND NATION2.N_NAME = 'GERMANY'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION3, LINEITEM LINEITEM1 
WHERE LINEITEM1.L_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND NATION3.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION3.N_NAME = 'ARGENTINA'
AND LINEITEM1.L_LINESTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM2 
WHERE LINEITEM2.L_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND LINEITEM2.L_PARTKEY = PARTSUPP0.PS_PARTKEY
AND LINEITEM2.L_LINESTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM3, PART PART1 
WHERE LINEITEM3.L_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND LINEITEM3.L_PARTKEY = PART1.P_PARTKEY
AND LINEITEM3.L_SHIPMODE = 'RAIL'
AND PART1.P_MFGR = 'Manufacturer#3'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER2 
WHERE CUSTOMER2.C_NATIONKEY = NATION0.N_NATIONKEY
AND CUSTOMER2.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER3 
WHERE CUSTOMER3.C_NATIONKEY = NATION0.N_NATIONKEY
AND CUSTOMER3.C_MKTSEGMENT = 'FURNITURE'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM4 
WHERE LINEITEM4.L_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND LINEITEM4.L_LINESTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1, CUSTOMER CUSTOMER4, SUPPLIER SUPPLIER1, LINEITEM LINEITEM5, REGION REGION2, PARTSUPP PARTSUPP1, PART PART2 
WHERE ORDERS1.O_ORDERKEY = LINEITEM5.L_ORDERKEY
AND ORDERS1.O_CUSTKEY = CUSTOMER4.C_CUSTKEY
AND SUPPLIER1.S_SUPPKEY = LINEITEM5.L_SUPPKEY
AND SUPPLIER1.S_SUPPKEY = PARTSUPP1.PS_SUPPKEY
AND LINEITEM5.L_PARTKEY = PARTSUPP1.PS_PARTKEY
AND LINEITEM5.L_PARTKEY = PART2.P_PARTKEY
AND REGION2.R_REGIONKEY = NATION0.N_REGIONKEY
AND CUSTOMER4.C_NATIONKEY = SUPPLIER1.S_NATIONKEY
AND CUSTOMER4.C_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM5.L_TAX = 0.08
AND PART2.P_MFGR = 'Manufacturer#2'
AND REGION2.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS2, CUSTOMER CUSTOMER5, SUPPLIER SUPPLIER2, LINEITEM LINEITEM6, REGION REGION3, PARTSUPP PARTSUPP2, PART PART3 
WHERE ORDERS2.O_ORDERKEY = LINEITEM6.L_ORDERKEY
AND ORDERS2.O_CUSTKEY = CUSTOMER5.C_CUSTKEY
AND REGION3.R_REGIONKEY = NATION0.N_REGIONKEY
AND CUSTOMER5.C_NATIONKEY = SUPPLIER2.S_NATIONKEY
AND CUSTOMER5.C_NATIONKEY = NATION0.N_NATIONKEY
AND SUPPLIER2.S_SUPPKEY = LINEITEM6.L_SUPPKEY
AND SUPPLIER2.S_SUPPKEY = PARTSUPP2.PS_SUPPKEY
AND LINEITEM6.L_PARTKEY = PARTSUPP2.PS_PARTKEY
AND LINEITEM6.L_PARTKEY = PART3.P_PARTKEY
AND ORDERS2.O_ORDERSTATUS = 'F'
AND REGION3.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER6, ORDERS ORDERS3 
WHERE CUSTOMER6.C_CUSTKEY = ORDERS3.O_CUSTKEY
AND CUSTOMER6.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS3.O_ORDERPRIORITY = '5-LOW'
AND CUSTOMER6.C_MKTSEGMENT = 'AUTOMOBILE'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS4, CUSTOMER CUSTOMER7 
WHERE CUSTOMER7.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS4.O_CUSTKEY = CUSTOMER7.C_CUSTKEY
AND ORDERS4.O_ORDERSTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION4, SUPPLIER SUPPLIER3, CUSTOMER CUSTOMER8, ORDERS ORDERS5 
WHERE NATION4.N_NATIONKEY = SUPPLIER3.S_NATIONKEY
AND NATION4.N_NATIONKEY = CUSTOMER8.C_NATIONKEY
AND SUPPLIER3.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND CUSTOMER8.C_CUSTKEY = ORDERS5.O_CUSTKEY
AND NATION4.N_NAME = 'JAPAN'
AND ORDERS5.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM7 
WHERE LINEITEM7.L_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND LINEITEM7.L_RETURNFLAG = 'N'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS6, LINEITEM LINEITEM8, CUSTOMER CUSTOMER9 
WHERE ORDERS6.O_ORDERKEY = LINEITEM8.L_ORDERKEY
AND CUSTOMER9.C_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM8.L_SHIPMODE = 'FOB'
AND CUSTOMER9.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM PARTSUPP PARTSUPP3, NATION NATION5, SUPPLIER SUPPLIER4, CUSTOMER CUSTOMER10 
WHERE PARTSUPP3.PS_SUPPKEY = SUPPLIER4.S_SUPPKEY
AND NATION5.N_NATIONKEY = SUPPLIER4.S_NATIONKEY
AND NATION5.N_NATIONKEY = CUSTOMER10.C_NATIONKEY
AND PARTSUPP3.PS_PARTKEY = PARTSUPP0.PS_PARTKEY
AND NATION5.N_NAME = 'JAPAN'
AND CUSTOMER10.C_MKTSEGMENT = 'HOUSEHOLD'
AND 'Manufacturer#1' = PART0.P_MFGR
)
AND NOT EXISTS(SELECT *
FROM PARTSUPP PARTSUPP4, NATION NATION6, SUPPLIER SUPPLIER5, CUSTOMER CUSTOMER11 
WHERE PARTSUPP4.PS_SUPPKEY = SUPPLIER5.S_SUPPKEY
AND NATION6.N_NATIONKEY = SUPPLIER5.S_NATIONKEY
AND NATION6.N_NATIONKEY = CUSTOMER11.C_NATIONKEY
AND PARTSUPP4.PS_PARTKEY = PARTSUPP0.PS_PARTKEY
AND NATION6.N_NAME = 'JAPAN'
AND CUSTOMER11.C_MKTSEGMENT = 'HOUSEHOLD'
AND 'Manufacturer#1' = PART0.P_MFGR
)
AND NOT EXISTS(SELECT *
FROM SUPPLIER SUPPLIER6, LINEITEM LINEITEM9, PART PART4 
WHERE SUPPLIER6.S_SUPPKEY = LINEITEM9.L_SUPPKEY
AND LINEITEM9.L_PARTKEY = PART4.P_PARTKEY
AND SUPPLIER6.S_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM9.L_TAX = 0.08
AND PART4.P_MFGR = 'Manufacturer#2'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION7, SUPPLIER SUPPLIER7, PART PART5, CUSTOMER CUSTOMER12 
WHERE NATION7.N_NATIONKEY = SUPPLIER7.S_NATIONKEY
AND NATION7.N_NATIONKEY = CUSTOMER12.C_NATIONKEY
AND SUPPLIER7.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND PART5.P_PARTKEY = PARTSUPP0.PS_PARTKEY
AND PART5.P_MFGR = 'Manufacturer#1'
AND NATION7.N_NAME = 'JAPAN'
AND CUSTOMER12.C_MKTSEGMENT = 'HOUSEHOLD'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION8, SUPPLIER SUPPLIER8, PART PART6, CUSTOMER CUSTOMER13 
WHERE NATION8.N_NATIONKEY = SUPPLIER8.S_NATIONKEY
AND NATION8.N_NATIONKEY = CUSTOMER13.C_NATIONKEY
AND SUPPLIER8.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND PART6.P_PARTKEY = PARTSUPP0.PS_PARTKEY
AND PART6.P_MFGR = 'Manufacturer#1'
AND NATION8.N_NAME = 'JAPAN'
AND CUSTOMER13.C_MKTSEGMENT = 'HOUSEHOLD'
)
AND NOT EXISTS(SELECT *
FROM SUPPLIER SUPPLIER9, CUSTOMER CUSTOMER14, ORDERS ORDERS7 
WHERE SUPPLIER9.S_NATIONKEY = CUSTOMER14.C_NATIONKEY
AND SUPPLIER9.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND CUSTOMER14.C_CUSTKEY = ORDERS7.O_CUSTKEY
AND ORDERS7.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION9, ORDERS ORDERS8, LINEITEM LINEITEM10, PARTSUPP PARTSUPP5, PART PART7 
WHERE ORDERS8.O_ORDERKEY = LINEITEM10.L_ORDERKEY
AND LINEITEM10.L_PARTKEY = PARTSUPP5.PS_PARTKEY
AND LINEITEM10.L_PARTKEY = PART7.P_PARTKEY
AND LINEITEM10.L_SUPPKEY = PARTSUPP5.PS_SUPPKEY
AND LINEITEM10.L_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND NATION9.N_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM10.L_SHIPMODE = 'RAIL'
AND ORDERS8.O_ORDERSTATUS = 'F'
AND PART7.P_MFGR = 'Manufacturer#3'
AND NATION9.N_NAME = 'GERMANY'
)

Executing the rewritten query results in 0 rows.

Planning: 
[115.806, 114.695, 115.043, 141.226, 137.066]
Execution: 
[240884.23, 242366.33, 242100.69, 242134.27, 239780.81]



