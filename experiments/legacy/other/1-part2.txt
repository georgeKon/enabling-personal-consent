Query Q(cff,cfe,cfj,cfi) :- LINEITEM(cfa,cfb,cfc,cfd,cfe,cff,cfg,cfh,cfi,cfj,cfk,cfl,cfm,cfn,cfo,cfp)

SELECT LINEITEM0.L_EXTENDEDPRICE, LINEITEM0.L_QUANTITY, LINEITEM0.L_LINESTATUS, LINEITEM0.L_RETURNFLAG 
FROM LINEITEM LINEITEM0 


Parsing query took 242 miliseconds
Query touches 41995307 rows
Planning: 
[2.753, 2.644, 6.194, 3.929, 3.711]
Execution: 
[154462.8, 154464.86, 154434.77, 154496.33, 154503.8]



For constraint Q(uw,va,vb) :- LINEITEM(us,ut,uu,uv,uw,ux,uy,uz,va,vb,vc,vd,ve,vf,vg,vh),ORDERS(us,vi,'F',vj,vk,vl,vm,vn,vo),CUSTOMER(vp,vq,vr,vs,vt,vu,vv,vw)
Constraint has 3 predicates
Constraint targetting 48.6% restrictivity
Constraint touches -1 rows
Rewriting query with constraint took 4 miliseconds
SELECT LINEITEM0.L_EXTENDEDPRICE, LINEITEM0.L_QUANTITY, LINEITEM0.L_LINESTATUS, LINEITEM0.L_RETURNFLAG 
FROM LINEITEM LINEITEM0 
WHERE NOT EXISTS(SELECT *
FROM ORDERS ORDERS0, CUSTOMER CUSTOMER0 
WHERE ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS0.O_ORDERSTATUS = 'F'
)

Executing the rewritten query results in 21657180 rows.

Planning: 
[14.38, 9.905, 10.978, 11.096, 9.043]
Execution: 
[204922.55, 204917.33, 203930.9, 206460.66, 200935.4]



For constraint Q(wb,wc) :- LINEITEM(vx,vy,vz,wa,wb,wc,wd,we,wf,wg,wh,wi,wj,wk,wl,wm),ORDERS(vx,wn,'P',wo,wp,wq,wr,ws,wt),NATION(wu,wv,ww,wx)
Constraint has 3 predicates
Constraint targetting 2.6% restrictivity
Constraint touches 32824625 rows
Rewriting query with constraint took 0 miliseconds
SELECT LINEITEM0.L_EXTENDEDPRICE, LINEITEM0.L_QUANTITY, LINEITEM0.L_LINESTATUS, LINEITEM0.L_RETURNFLAG 
FROM LINEITEM LINEITEM0 
WHERE NOT EXISTS(SELECT *
FROM ORDERS ORDERS0, NATION NATION0 
WHERE ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS0.O_ORDERSTATUS = 'P'
)

Executing the rewritten query results in 40682322 rows.

Planning: 
[12.777, 8.803, 14.537, 15.041, 12.466]
Execution: 
[277429.6, 277996.56, 273805.4, 266425.62, 274994.78]



Running the query against every constraint
Rewriting query with all constraints took 13 miliseconds
For this query, rewriting with all constraints produced 22 successful unifications.
SELECT LINEITEM0.L_EXTENDEDPRICE, LINEITEM0.L_QUANTITY, LINEITEM0.L_LINESTATUS, LINEITEM0.L_RETURNFLAG 
FROM LINEITEM LINEITEM0 
WHERE (
'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCTOR 'N' != LINEITEM0.L_RETURNFLAG)AND (
'N' != LINEITEM0.L_RETURNFLAG)AND (
1 != LINEITEM0.L_LINENUMBEROR 'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCTOR 0.02 != LINEITEM0.L_TAX)AND (
0.05 != LINEITEM0.L_TAXOR 4 != LINEITEM0.L_LINENUMBER)AND NOT EXISTS(SELECT *
FROM PART PART0, PARTSUPP PARTSUPP0 
WHERE PARTSUPP0.PS_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART0.P_PARTKEY = PARTSUPP0.PS_PARTKEY
AND PART0.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART0.P_BRAND = 'Brand#54'
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS0 
WHERE ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS0.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM PART PART1 
WHERE PART1.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART1.P_MFGR = 'Manufacturer#4'
AND 6 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM PART PART2, PARTSUPP PARTSUPP1, ORDERS ORDERS1 
WHERE PART2.P_PARTKEY = PARTSUPP1.PS_PARTKEY
AND PART2.P_PARTKEY = LINEITEM0.L_PARTKEY
AND ORDERS1.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND PART2.P_CONTAINER = 'WRAP PKG'
AND PART2.P_MFGR = 'Manufacturer#5'
AND PART2.P_BRAND = 'Brand#54'
AND ORDERS1.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM PART PART3 
WHERE PART3.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART3.P_CONTAINER = 'WRAP PKG'
AND PART3.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS2 
WHERE ORDERS2.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS2.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS3, CUSTOMER CUSTOMER0, NATION NATION0 
WHERE CUSTOMER0.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS3.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_REGIONKEY = 0
AND CUSTOMER0.C_MKTSEGMENT = 'MACHINERY'
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS4 
WHERE ORDERS4.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS4.O_ORDERSTATUS = 'P'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS5, CUSTOMER CUSTOMER1 
WHERE ORDERS5.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS5.O_ORDERSTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS6 
WHERE ORDERS6.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS7 
WHERE ORDERS7.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS7.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM PART PART4, ORDERS ORDERS8 
WHERE PART4.P_PARTKEY = LINEITEM0.L_PARTKEY
AND ORDERS8.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND PART4.P_CONTAINER = 'WRAP PKG'
AND PART4.P_MFGR = 'Manufacturer#5'
AND PART4.P_BRAND = 'Brand#54'
AND ORDERS8.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS9 
WHERE ORDERS9.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS9.O_ORDERSTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS10, NATION NATION1 
WHERE ORDERS10.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS10.O_ORDERSTATUS = 'P'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS11 
WHERE ORDERS11.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS11.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS12, CUSTOMER CUSTOMER2 
WHERE ORDERS12.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM PART PART5, PARTSUPP PARTSUPP2 
WHERE PARTSUPP2.PS_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART5.P_PARTKEY = PARTSUPP2.PS_PARTKEY
AND PART5.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART5.P_BRAND = 'Brand#54'
AND 1 = LINEITEM0.L_LINENUMBER
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
AND 0.02 = LINEITEM0.L_TAX
)
AND NOT EXISTS(SELECT *
FROM PART PART6, PARTSUPP PARTSUPP3 
WHERE PART6.P_PARTKEY = PARTSUPP3.PS_PARTKEY
AND PART6.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART6.P_CONTAINER = 'WRAP PKG'
AND PART6.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)

Executing the rewritten query results in -1 rows.

Planning: 
[0.0, 0.0, 0.0, 0.0, 0.0]
Execution: 
[0.0, 0.0, 0.0, 0.0, 0.0]



