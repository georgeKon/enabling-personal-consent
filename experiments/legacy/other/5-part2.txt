Query Q(cie) :- NATION(cic,cie,cid,cif),ORDERS(cia,chz,cig,cih,cii,cij,cik,cil,cim),CUSTOMER(chz,cin,cio,cic,cip,ciq,cir,cis),SUPPLIER(cib,cit,ciu,cic,civ,ciw,cix),LINEITEM(cia,ciy,cib,ciz,cja,cjb,cjc,cjd,cje,cjf,cjg,cjh,cji,cjj,cjk,cjl),REGION(cid,'AMERICA',cjm)

SELECT NATION0.N_NAME 
FROM NATION NATION0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND REGION0.R_NAME = 'AMERICA'


Parsing query took 7 miliseconds
Query touches 336919 rows
Planning: 
[22.905, 24.924, 21.008, 19.326, 20.673]
Execution: 
[237617.08, 231539.17, 232757.06, 234869.08, 230810.98]



For constraint Q(b) :- NATION(a,b,c,d),ORDERS(e,f,'F',g,h,i,j,k,l),CUSTOMER(f,m,n,a,o,p,q,r),SUPPLIER(s,t,u,a,v,w,x),LINEITEM(e,y,s,z,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al),REGION(c,'AMERICA',am),PARTSUPP(y,s,an,ao,ap),PART(y,aq,ar,as,at,au,av,aw,ax)
Constraint has 8 predicates
Constraint targetting 48.6% restrictivity
Constraint touches 163599 rows
Rewriting query with constraint took 1 miliseconds
SELECT NATION0.N_NAME 
FROM NATION NATION0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND REGION0.R_NAME = 'AMERICA'
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1, CUSTOMER CUSTOMER1, SUPPLIER SUPPLIER1, LINEITEM LINEITEM1, REGION REGION1, PARTSUPP PARTSUPP0, PART PART0 
WHERE ORDERS1.O_ORDERKEY = LINEITEM1.L_ORDERKEY
AND ORDERS1.O_CUSTKEY = CUSTOMER1.C_CUSTKEY
AND SUPPLIER1.S_SUPPKEY = LINEITEM1.L_SUPPKEY
AND SUPPLIER1.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND LINEITEM1.L_PARTKEY = PARTSUPP0.PS_PARTKEY
AND LINEITEM1.L_PARTKEY = PART0.P_PARTKEY
AND CUSTOMER1.C_NATIONKEY = SUPPLIER1.S_NATIONKEY
AND CUSTOMER1.C_NATIONKEY = NATION0.N_NATIONKEY
AND REGION1.R_REGIONKEY = NATION0.N_REGIONKEY
AND ORDERS1.O_ORDERSTATUS = 'F'
AND REGION1.R_NAME = 'AMERICA'
)

Executing the rewritten query results in 0 rows.

Planning: 
[56.036, 52.212, 49.995, 49.938, 52.878]
Execution: 
[324242.62, 322643.53, 323708.12, 318209.22, 323272.56]



For constraint Q(az) :- NATION(ay,az,ba,bb),ORDERS(bc,bd,be,bf,bg,bh,bi,bj,bk),CUSTOMER(bd,bl,bm,ay,bn,bo,bp,bq),SUPPLIER(br,bs,bt,ay,bu,bv,bw),LINEITEM(bc,bx,br,by,bz,ca,cb,0.08,cc,cd,ce,cf,cg,ch,ci,cj),REGION(ba,'AMERICA',ck),PARTSUPP(bx,br,cl,cm,cn),PART(bx,co,'Manufacturer#2',cp,cq,cr,cs,ct,cu)
Constraint has 8 predicates
Constraint targetting 2.22% restrictivity
Constraint touches 7585 rows
Rewriting query with constraint took 1 miliseconds
SELECT NATION0.N_NAME 
FROM NATION NATION0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND REGION0.R_NAME = 'AMERICA'
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1, CUSTOMER CUSTOMER1, SUPPLIER SUPPLIER1, LINEITEM LINEITEM1, REGION REGION1, PARTSUPP PARTSUPP0, PART PART0 
WHERE ORDERS1.O_ORDERKEY = LINEITEM1.L_ORDERKEY
AND ORDERS1.O_CUSTKEY = CUSTOMER1.C_CUSTKEY
AND SUPPLIER1.S_SUPPKEY = LINEITEM1.L_SUPPKEY
AND SUPPLIER1.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND LINEITEM1.L_PARTKEY = PARTSUPP0.PS_PARTKEY
AND LINEITEM1.L_PARTKEY = PART0.P_PARTKEY
AND CUSTOMER1.C_NATIONKEY = SUPPLIER1.S_NATIONKEY
AND CUSTOMER1.C_NATIONKEY = NATION0.N_NATIONKEY
AND REGION1.R_REGIONKEY = NATION0.N_REGIONKEY
AND LINEITEM1.L_TAX = 0.08
AND PART0.P_MFGR = 'Manufacturer#2'
AND REGION1.R_NAME = 'AMERICA'
)

Executing the rewritten query results in 0 rows.

Planning: 
[50.898, 54.83, 49.224, 51.377, 49.142]
Execution: 
[246585.86, 248614.33, 247171.8, 257583.94, 255866.02]



Running the query against every constraint
Rewriting query with all constraints took 25 miliseconds
For this query, rewriting with all constraints produced 16 successful unifications.
SELECT NATION0.N_NAME 
FROM NATION NATION0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION0.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND REGION0.R_NAME = 'AMERICA'
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1, LINEITEM LINEITEM1, CUSTOMER CUSTOMER1 
WHERE ORDERS1.O_ORDERKEY = LINEITEM1.L_ORDERKEY
AND CUSTOMER1.C_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM1.L_SHIPMODE = 'FOB'
AND CUSTOMER1.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS2, CUSTOMER CUSTOMER2, NATION NATION1 
WHERE CUSTOMER2.C_NATIONKEY = NATION1.N_NATIONKEY
AND ORDERS2.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND NATION1.N_REGIONKEY = 0
AND CUSTOMER2.C_MKTSEGMENT = 'MACHINERY'
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS3, CUSTOMER CUSTOMER3 
WHERE ORDERS3.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM SUPPLIER SUPPLIER1, LINEITEM LINEITEM2, PART PART0 
WHERE SUPPLIER1.S_SUPPKEY = LINEITEM2.L_SUPPKEY
AND LINEITEM2.L_PARTKEY = PART0.P_PARTKEY
AND SUPPLIER1.S_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM2.L_TAX = 0.08
AND PART0.P_MFGR = 'Manufacturer#2'
)
AND NOT EXISTS(SELECT *
FROM NATION NATION2 
WHERE NATION2.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION2.N_REGIONKEY = 0
AND 'MACHINERY' = CUSTOMER0.C_MKTSEGMENT
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER4, ORDERS ORDERS4 
WHERE CUSTOMER4.C_CUSTKEY = ORDERS4.O_CUSTKEY
AND CUSTOMER4.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS4.O_ORDERPRIORITY = '5-LOW'
AND CUSTOMER4.C_MKTSEGMENT = 'AUTOMOBILE'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS5, LINEITEM LINEITEM3, NATION NATION3 
WHERE ORDERS5.O_ORDERKEY = LINEITEM3.L_ORDERKEY
AND NATION3.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION3.N_REGIONKEY = 0
AND LINEITEM3.L_SHIPMODE = 'FOB'
AND 'MACHINERY' = CUSTOMER0.C_MKTSEGMENT
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS6 
WHERE ORDERS6.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS7, CUSTOMER CUSTOMER5, SUPPLIER SUPPLIER2, LINEITEM LINEITEM4, REGION REGION1, PARTSUPP PARTSUPP0, PART PART1 
WHERE ORDERS7.O_ORDERKEY = LINEITEM4.L_ORDERKEY
AND ORDERS7.O_CUSTKEY = CUSTOMER5.C_CUSTKEY
AND SUPPLIER2.S_SUPPKEY = LINEITEM4.L_SUPPKEY
AND SUPPLIER2.S_SUPPKEY = PARTSUPP0.PS_SUPPKEY
AND LINEITEM4.L_PARTKEY = PARTSUPP0.PS_PARTKEY
AND LINEITEM4.L_PARTKEY = PART1.P_PARTKEY
AND CUSTOMER5.C_NATIONKEY = SUPPLIER2.S_NATIONKEY
AND CUSTOMER5.C_NATIONKEY = NATION0.N_NATIONKEY
AND REGION1.R_REGIONKEY = NATION0.N_REGIONKEY
AND LINEITEM4.L_TAX = 0.08
AND PART1.P_MFGR = 'Manufacturer#2'
AND REGION1.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS8, CUSTOMER CUSTOMER6, SUPPLIER SUPPLIER3, LINEITEM LINEITEM5, REGION REGION2, PARTSUPP PARTSUPP1, PART PART2 
WHERE ORDERS8.O_ORDERKEY = LINEITEM5.L_ORDERKEY
AND ORDERS8.O_CUSTKEY = CUSTOMER6.C_CUSTKEY
AND SUPPLIER3.S_SUPPKEY = LINEITEM5.L_SUPPKEY
AND SUPPLIER3.S_SUPPKEY = PARTSUPP1.PS_SUPPKEY
AND LINEITEM5.L_PARTKEY = PARTSUPP1.PS_PARTKEY
AND LINEITEM5.L_PARTKEY = PART2.P_PARTKEY
AND CUSTOMER6.C_NATIONKEY = SUPPLIER3.S_NATIONKEY
AND CUSTOMER6.C_NATIONKEY = NATION0.N_NATIONKEY
AND REGION2.R_REGIONKEY = NATION0.N_REGIONKEY
AND ORDERS8.O_ORDERSTATUS = 'F'
AND REGION2.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS9, LINEITEM LINEITEM6 
WHERE ORDERS9.O_ORDERKEY = LINEITEM6.L_ORDERKEY
AND LINEITEM6.L_RETURNFLAG = 'N'
AND LINEITEM6.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM7, CUSTOMER CUSTOMER7, NATION NATION4 
WHERE CUSTOMER7.C_NATIONKEY = NATION4.N_NATIONKEY
AND LINEITEM7.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND NATION4.N_REGIONKEY = 0
AND LINEITEM7.L_SHIPMODE = 'FOB'
AND CUSTOMER7.C_MKTSEGMENT = 'MACHINERY'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS10, CUSTOMER CUSTOMER8 
WHERE CUSTOMER8.C_NATIONKEY = NATION0.N_NATIONKEY
AND ORDERS10.O_CUSTKEY = CUSTOMER8.C_CUSTKEY
AND ORDERS10.O_ORDERSTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM8, CUSTOMER CUSTOMER9 
WHERE LINEITEM8.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM8.L_RETURNFLAG = 'N'
AND LINEITEM8.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER10 
WHERE CUSTOMER10.C_NATIONKEY = NATION0.N_NATIONKEY
AND CUSTOMER10.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM9 
WHERE LINEITEM9.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM9.L_RETURNFLAG = 'N'
AND LINEITEM9.L_SHIPMODE = 'FOB'
)

Executing the rewritten query results in 0 rows.

Planning: 
[87.021, 85.125, 96.124, 86.544, 87.147]
Execution: 
[1.233, 1.149, 1.174, 1.132, 1.237]



