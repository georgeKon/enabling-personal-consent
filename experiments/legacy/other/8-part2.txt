Query Q(cmn,cmb,cnf) :- NATION(clw,clz,clx,cma),NATION(cly,cmb,cmc,cmd),PART(cls,cme,cmf,cmg,'LARGE POLISHED COPPER',cmh,cmi,cmj,cmk),ORDERS(clu,clv,cml,cmm,cmn,cmo,cmp,cmq,cmr),CUSTOMER(clv,cms,cmt,clw,cmu,cmv,cmw,cmx),SUPPLIER(clt,cmy,cmz,cly,cna,cnb,cnc),LINEITEM(clu,cls,clt,cnd,cne,cnf,cng,cnh,cni,cnj,cnk,cnl,cnm,cnn,cno,cnp),REGION(clx,'AFRICA',cnq)

SELECT ORDERS0.O_ORDERDATE, NATION1.N_NAME, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, PART PART0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART0.P_PARTKEY = LINEITEM0.L_PARTKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION1.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_TYPE = 'LARGE POLISHED COPPER'
AND REGION0.R_NAME = 'AFRICA'


Parsing query took 1 miliseconds
Query touches 56430 rows
Planning: 
[35.035, 29.766, 28.505, 26.011, 20.203]
Execution: 
[440371.62, 461405.7, 439405.4, 452692.38, 442224.6]



For constraint Q(bkn,bju,bjg) :- NATION(bjb,bjc,bjd,bje),NATION(bjf,bjg,bjh,bji),PART(bjj,bjk,bjl,bjm,'LARGE POLISHED COPPER',bjn,bjo,bjp,bjq),ORDERS(bjr,bjs,'F',bjt,bju,bjv,bjw,bjx,bjy),CUSTOMER(bjs,bjz,bka,bjb,bkb,bkc,bkd,bke),SUPPLIER(bkf,bkg,bkh,bjf,bki,bkj,bkk),LINEITEM(bjr,bjj,bkf,bkl,bkm,bkn,bko,bkp,bkq,bkr,bks,bkt,bku,bkv,bkw,bkx),REGION(bjd,'AFRICA',bky),PARTSUPP(bkz,bkf,bla,blb,blc),PART(bkz,bld,ble,blf,blg,blh,bli,blj,blk)
Constraint has 10 predicates
Constraint targetting 48.6% restrictivity
Constraint touches 2180400 rows
Rewriting query with constraint took 2 miliseconds
SELECT ORDERS0.O_ORDERDATE, NATION1.N_NAME, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, PART PART0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART0.P_PARTKEY = LINEITEM0.L_PARTKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION1.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_TYPE = 'LARGE POLISHED COPPER'
AND REGION0.R_NAME = 'AFRICA'

Executing the rewritten query results in 56430 rows.

Planning: 
[25.227, 25.895, 25.23, 25.218, 28.483]
Execution: 
[444592.62, 440817.75, 450104.34, 450906.44, 455588.8]



For constraint Q(blq,bmf,bmx) :- NATION(bll,blm,bln,blo),NATION(blp,blq,blr,bls),PART(blt,blu,blv,blw,'LARGE POLISHED COPPER',blx,bly,blz,bma),ORDERS(bmb,bmc,bmd,bme,bmf,bmg,bmh,bmi,bmj),CUSTOMER(bmc,bmk,bml,bll,bmm,bmn,bmo,bmp),SUPPLIER(bmq,bmr,bms,blp,bmt,bmu,bmv),LINEITEM(bmb,blt,bmq,4,bmw,bmx,bmy,0.05,bmz,bna,bnb,bnc,bnd,bne,bnf,bng),REGION(bln,'AFRICA',bnh),PARTSUPP(bni,bmq,bnj,bnk,bnl),PART(bni,bnm,bnn,bno,bnp,bnq,bnr,bns,bnt)
Constraint has 10 predicates
Constraint targetting 1.5873% restrictivity
Constraint touches 74080 rows
Rewriting query with constraint took 2 miliseconds
SELECT ORDERS0.O_ORDERDATE, NATION1.N_NAME, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, PART PART0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART0.P_PARTKEY = LINEITEM0.L_PARTKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION1.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_TYPE = 'LARGE POLISHED COPPER'
AND REGION0.R_NAME = 'AFRICA'

Executing the rewritten query results in 56430 rows.

Planning: 
[40.255, 18.78, 35.798, 25.081, 30.467]
Execution: 
[444628.1, 446173.7, 447170.9, 428196.22, 469618.1]



Running the query against every constraint
Rewriting query with all constraints took 32 miliseconds
For this query, rewriting with all constraints produced 34 successful unifications.
SELECT ORDERS0.O_ORDERDATE, NATION1.N_NAME, LINEITEM0.L_EXTENDEDPRICE 
FROM NATION NATION0, NATION NATION1, PART PART0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, SUPPLIER SUPPLIER0, LINEITEM LINEITEM0, REGION REGION0 
WHERE SUPPLIER0.S_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART0.P_PARTKEY = LINEITEM0.L_PARTKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION1.N_NATIONKEY = SUPPLIER0.S_NATIONKEY
AND PART0.P_TYPE = 'LARGE POLISHED COPPER'
AND REGION0.R_NAME = 'AFRICA'
AND (
'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCTOR 'N' != LINEITEM0.L_RETURNFLAG)AND (
'N' != LINEITEM0.L_RETURNFLAG)AND (
4 != LINEITEM0.L_LINENUMBEROR 0.05 != LINEITEM0.L_TAX)AND (
0.02 != LINEITEM0.L_TAXOR 1 != LINEITEM0.L_LINENUMBEROR 'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCT)AND (
'F' != ORDERS0.O_ORDERSTATUS)AND NOT EXISTS(SELECT *
FROM PART PART1 
WHERE PART1.P_PARTKEY = PART0.P_PARTKEY
AND PART1.P_MFGR = 'Manufacturer#4'
AND 6 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1 
WHERE ORDERS1.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS1.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM SUPPLIER SUPPLIER1, LINEITEM LINEITEM1, PART PART2 
WHERE SUPPLIER1.S_SUPPKEY = LINEITEM1.L_SUPPKEY
AND LINEITEM1.L_PARTKEY = PART2.P_PARTKEY
AND SUPPLIER1.S_NATIONKEY = NATION1.N_NATIONKEY
AND LINEITEM1.L_TAX = 0.08
AND PART2.P_MFGR = 'Manufacturer#2'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER1 
WHERE CUSTOMER1.C_NATIONKEY = NATION1.N_NATIONKEY
AND CUSTOMER1.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION1.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER2, ORDERS ORDERS2 
WHERE CUSTOMER2.C_CUSTKEY = ORDERS2.O_CUSTKEY
AND CUSTOMER2.C_NATIONKEY = NATION1.N_NATIONKEY
AND ORDERS2.O_ORDERPRIORITY = '5-LOW'
AND CUSTOMER2.C_MKTSEGMENT = 'AUTOMOBILE'
)
AND NOT EXISTS(SELECT *
FROM PART PART3, PARTSUPP PARTSUPP0, ORDERS ORDERS3 
WHERE PART3.P_PARTKEY = PARTSUPP0.PS_PARTKEY
AND PART3.P_PARTKEY = PART0.P_PARTKEY
AND ORDERS3.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND PART3.P_CONTAINER = 'WRAP PKG'
AND PART3.P_MFGR = 'Manufacturer#5'
AND PART3.P_BRAND = 'Brand#54'
AND ORDERS3.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS4, LINEITEM LINEITEM2, CUSTOMER CUSTOMER3 
WHERE ORDERS4.O_ORDERKEY = LINEITEM2.L_ORDERKEY
AND CUSTOMER3.C_NATIONKEY = NATION0.N_NATIONKEY
AND LINEITEM2.L_SHIPMODE = 'FOB'
AND CUSTOMER3.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS5, CUSTOMER CUSTOMER4, NATION NATION2 
WHERE ORDERS5.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND CUSTOMER4.C_NATIONKEY = NATION2.N_NATIONKEY
AND NATION2.N_REGIONKEY = 0
AND CUSTOMER4.C_MKTSEGMENT = 'MACHINERY'
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM NATION NATION3 
WHERE NATION3.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION3.N_REGIONKEY = 0
AND 'MACHINERY' = CUSTOMER0.C_MKTSEGMENT
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS6, CUSTOMER CUSTOMER5 
WHERE CUSTOMER5.C_NATIONKEY = NATION1.N_NATIONKEY
AND ORDERS6.O_CUSTKEY = CUSTOMER5.C_CUSTKEY
AND ORDERS6.O_ORDERSTATUS = 'F'
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM3 
WHERE LINEITEM3.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM3.L_RETURNFLAG = 'N'
AND LINEITEM3.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM PART PART4, PARTSUPP PARTSUPP1 
WHERE PART4.P_PARTKEY = PARTSUPP1.PS_PARTKEY
AND PART4.P_PARTKEY = PART0.P_PARTKEY
AND PART4.P_CONTAINER = 'WRAP PKG'
AND PART4.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS7, CUSTOMER CUSTOMER6, SUPPLIER SUPPLIER2, LINEITEM LINEITEM4, REGION REGION1, PARTSUPP PARTSUPP2, PART PART5 
WHERE ORDERS7.O_ORDERKEY = LINEITEM4.L_ORDERKEY
AND ORDERS7.O_CUSTKEY = CUSTOMER6.C_CUSTKEY
AND CUSTOMER6.C_NATIONKEY = SUPPLIER2.S_NATIONKEY
AND CUSTOMER6.C_NATIONKEY = NATION1.N_NATIONKEY
AND SUPPLIER2.S_SUPPKEY = LINEITEM4.L_SUPPKEY
AND SUPPLIER2.S_SUPPKEY = PARTSUPP2.PS_SUPPKEY
AND REGION1.R_REGIONKEY = NATION1.N_REGIONKEY
AND LINEITEM4.L_PARTKEY = PARTSUPP2.PS_PARTKEY
AND LINEITEM4.L_PARTKEY = PART5.P_PARTKEY
AND ORDERS7.O_ORDERSTATUS = 'F'
AND REGION1.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM PART PART6, PARTSUPP PARTSUPP3 
WHERE PARTSUPP3.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PART6.P_PARTKEY = PARTSUPP3.PS_PARTKEY
AND PART6.P_PARTKEY = PART0.P_PARTKEY
AND PART6.P_BRAND = 'Brand#54'
AND 0.02 = LINEITEM0.L_TAX
AND 1 = LINEITEM0.L_LINENUMBER
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS8 
WHERE ORDERS8.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS8.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS9, LINEITEM LINEITEM5, CUSTOMER CUSTOMER7 
WHERE ORDERS9.O_ORDERKEY = LINEITEM5.L_ORDERKEY
AND CUSTOMER7.C_NATIONKEY = NATION1.N_NATIONKEY
AND LINEITEM5.L_SHIPMODE = 'FOB'
AND CUSTOMER7.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION1.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM PART PART7 
WHERE PART7.P_PARTKEY = PART0.P_PARTKEY
AND PART7.P_CONTAINER = 'WRAP PKG'
AND PART7.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS10, CUSTOMER CUSTOMER8, SUPPLIER SUPPLIER3, LINEITEM LINEITEM6, REGION REGION2, PARTSUPP PARTSUPP4, PART PART8 
WHERE ORDERS10.O_ORDERKEY = LINEITEM6.L_ORDERKEY
AND ORDERS10.O_CUSTKEY = CUSTOMER8.C_CUSTKEY
AND SUPPLIER3.S_SUPPKEY = LINEITEM6.L_SUPPKEY
AND SUPPLIER3.S_SUPPKEY = PARTSUPP4.PS_SUPPKEY
AND LINEITEM6.L_PARTKEY = PARTSUPP4.PS_PARTKEY
AND LINEITEM6.L_PARTKEY = PART8.P_PARTKEY
AND CUSTOMER8.C_NATIONKEY = SUPPLIER3.S_NATIONKEY
AND CUSTOMER8.C_NATIONKEY = NATION1.N_NATIONKEY
AND REGION2.R_REGIONKEY = NATION1.N_REGIONKEY
AND LINEITEM6.L_TAX = 0.08
AND PART8.P_MFGR = 'Manufacturer#2'
AND REGION2.R_NAME = 'AMERICA'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS11, LINEITEM LINEITEM7 
WHERE ORDERS11.O_ORDERKEY = LINEITEM7.L_ORDERKEY
AND LINEITEM7.L_RETURNFLAG = 'N'
AND LINEITEM7.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS12, CUSTOMER CUSTOMER9 
WHERE ORDERS12.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM8, CUSTOMER CUSTOMER10 
WHERE LINEITEM8.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM8.L_RETURNFLAG = 'N'
AND LINEITEM8.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER11 
WHERE CUSTOMER11.C_NATIONKEY = NATION0.N_NATIONKEY
AND CUSTOMER11.C_MKTSEGMENT = 'MACHINERY'
AND 0 = NATION0.N_REGIONKEY
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM9, CUSTOMER CUSTOMER12, NATION NATION4 
WHERE LINEITEM9.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND CUSTOMER12.C_NATIONKEY = NATION4.N_NATIONKEY
AND NATION4.N_REGIONKEY = 0
AND LINEITEM9.L_SHIPMODE = 'FOB'
AND CUSTOMER12.C_MKTSEGMENT = 'MACHINERY'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS13 
WHERE ORDERS13.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS13.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM PART PART9, ORDERS ORDERS14 
WHERE PART9.P_PARTKEY = PART0.P_PARTKEY
AND ORDERS14.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND PART9.P_CONTAINER = 'WRAP PKG'
AND PART9.P_MFGR = 'Manufacturer#5'
AND PART9.P_BRAND = 'Brand#54'
AND ORDERS14.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS15 
WHERE ORDERS15.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS15.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM PART PART10, PARTSUPP PARTSUPP5 
WHERE PARTSUPP5.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PART10.P_PARTKEY = PARTSUPP5.PS_PARTKEY
AND PART10.P_PARTKEY = PART0.P_PARTKEY
AND PART10.P_BRAND = 'Brand#54'
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS16 
WHERE ORDERS16.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS17, LINEITEM LINEITEM10, NATION NATION5 
WHERE ORDERS17.O_ORDERKEY = LINEITEM10.L_ORDERKEY
AND NATION5.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION5.N_REGIONKEY = 0
AND LINEITEM10.L_SHIPMODE = 'FOB'
AND 'MACHINERY' = CUSTOMER0.C_MKTSEGMENT
)

Executing the rewritten query results in -1 rows.

Planning: 
[0.0, 0.0, 0.0, 0.0, 0.0]
Execution: 
[0.0, 0.0, 0.0, 0.0, 0.0]



