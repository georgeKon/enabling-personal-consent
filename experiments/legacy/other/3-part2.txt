Query Q(chf,cgt,cgn,cgq) :- ORDERS(cgn,cgm,cgo,cgp,cgq,cgr,cgs,cgt,cgu),CUSTOMER(cgm,cgv,cgw,cgx,cgy,cgz,'MACHINERY',cha),LINEITEM(cgn,chb,chc,chd,che,chf,chg,chh,chi,chj,chk,chl,chm,chn,cho,chp)

SELECT LINEITEM0.L_EXTENDEDPRICE, ORDERS0.O_SHIPPRIORITY, ORDERS0.O_ORDERKEY, ORDERS0.O_ORDERDATE 
FROM ORDERS ORDERS0, CUSTOMER CUSTOMER0, LINEITEM LINEITEM0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND CUSTOMER0.C_MKTSEGMENT = 'MACHINERY'


Parsing query took 2 miliseconds
Query touches 8399634 rows
Planning: 
[22.83, 18.528, 20.793, 15.204, 14.789]
Execution: 
[265554.56, 268249.88, 260389.53, 259597.69, 267886.0]



For constraint Q(ayi,ayc,ayu,ayf) :- ORDERS(ayc,ayd,'O',aye,ayf,ayg,ayh,ayi,ayj),CUSTOMER(ayd,ayk,ayl,aym,ayn,ayo,'MACHINERY',ayp),LINEITEM(ayc,ayq,ayr,ays,ayt,ayu,ayv,ayw,ayx,ayy,ayz,aza,azb,azc,azd,aze),NATION(aym,azf,azg,azh),REGION(azg,azi,azj)
Constraint has 5 predicates
Constraint targetting 48.8% restrictivity
Constraint touches 4070920 rows
Rewriting query with constraint took 0 miliseconds
SELECT LINEITEM0.L_EXTENDEDPRICE, ORDERS0.O_SHIPPRIORITY, ORDERS0.O_ORDERKEY, ORDERS0.O_ORDERDATE 
FROM ORDERS ORDERS0, CUSTOMER CUSTOMER0, LINEITEM LINEITEM0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND CUSTOMER0.C_MKTSEGMENT = 'MACHINERY'
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER1, NATION NATION0, REGION REGION0 
WHERE CUSTOMER1.C_NATIONKEY = NATION0.N_NATIONKEY
AND CUSTOMER1.C_CUSTKEY = ORDERS0.O_CUSTKEY
AND NATION0.N_REGIONKEY = REGION0.R_REGIONKEY
AND CUSTOMER1.C_MKTSEGMENT = 'MACHINERY'
AND 'O' = ORDERS0.O_ORDERSTATUS
)

Executing the rewritten query results in 4328714 rows.

Planning: 
[26.137, 14.168, 14.22, 25.19, 24.139]
Execution: 
[261855.67, 264922.7, 256128.06, 262618.44, 257133.45]



For constraint Q(azk,bac,azo,azr) :- ORDERS(azk,azl,azm,azn,azo,azp,azq,azr,azs),CUSTOMER(azl,azt,azu,azv,azw,azx,'MACHINERY',azy),LINEITEM(azk,azz,baa,6,bab,bac,bad,bae,baf,bag,bah,bai,baj,bak,bal,bam),PARTSUPP(azz,baa,ban,bao,bap),PART(azz,baq,'Manufacturer#4',bar,bas,bat,bau,bav,baw),SUPPLIER(baa,bax,bay,baz,bba,bbb,bbc)
Constraint has 6 predicates
Constraint targetting 1.42% restrictivity
Constraint touches 120245 rows
Rewriting query with constraint took 1 miliseconds
SELECT LINEITEM0.L_EXTENDEDPRICE, ORDERS0.O_SHIPPRIORITY, ORDERS0.O_ORDERKEY, ORDERS0.O_ORDERDATE 
FROM ORDERS ORDERS0, CUSTOMER CUSTOMER0, LINEITEM LINEITEM0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND CUSTOMER0.C_MKTSEGMENT = 'MACHINERY'
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER1, PARTSUPP PARTSUPP0, PART PART0, SUPPLIER SUPPLIER0 
WHERE CUSTOMER1.C_CUSTKEY = ORDERS0.O_CUSTKEY
AND PARTSUPP0.PS_PARTKEY = PART0.P_PARTKEY
AND PARTSUPP0.PS_PARTKEY = LINEITEM0.L_PARTKEY
AND PARTSUPP0.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PARTSUPP0.PS_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART0.P_MFGR = 'Manufacturer#4'
AND CUSTOMER1.C_MKTSEGMENT = 'MACHINERY'
AND 6 = LINEITEM0.L_LINENUMBER
)

Executing the rewritten query results in 8279389 rows.

Planning: 
[35.251, 30.582, 26.275, 35.629, 29.95]
Execution: 
[671428.75, 661559.94, 665969.94, 666171.2, 669337.3]



Running the query against every constraint
Rewriting query with all constraints took 17 miliseconds
For this query, rewriting with all constraints produced 37 successful unifications.
SELECT LINEITEM0.L_EXTENDEDPRICE, ORDERS0.O_SHIPPRIORITY, ORDERS0.O_ORDERKEY, ORDERS0.O_ORDERDATE 
FROM ORDERS ORDERS0, CUSTOMER CUSTOMER0, LINEITEM LINEITEM0 
WHERE ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND CUSTOMER0.C_MKTSEGMENT = 'MACHINERY'
AND (
'F' != LINEITEM0.L_LINESTATUS)AND (
'O' != ORDERS0.O_ORDERSTATUS)AND (
'N' != LINEITEM0.L_RETURNFLAGOR 'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCT)AND (
0.05 != LINEITEM0.L_TAXOR 4 != LINEITEM0.L_LINENUMBER)AND (
'DELIVER IN PERSON' != LINEITEM0.L_SHIPINSTRUCTOR 1 != LINEITEM0.L_LINENUMBEROR 0.02 != LINEITEM0.L_TAX)AND (
'N' != LINEITEM0.L_RETURNFLAG)AND (
'F' != ORDERS0.O_ORDERSTATUS)AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1 
WHERE ORDERS1.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 7 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS2, CUSTOMER CUSTOMER1, NATION NATION0 
WHERE ORDERS2.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND CUSTOMER1.C_NATIONKEY = NATION0.N_NATIONKEY
AND NATION0.N_REGIONKEY = 0
AND CUSTOMER1.C_MKTSEGMENT = 'MACHINERY'
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS3 
WHERE ORDERS3.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM PART PART0, PARTSUPP PARTSUPP0 
WHERE PART0.P_PARTKEY = PARTSUPP0.PS_PARTKEY
AND PART0.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PARTSUPP0.PS_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART0.P_BRAND = 'Brand#54'
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
AND 1 = LINEITEM0.L_LINENUMBER
AND 0.02 = LINEITEM0.L_TAX
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM1 
WHERE LINEITEM1.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM1.L_RETURNFLAG = 'N'
AND LINEITEM1.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS4, CUSTOMER CUSTOMER2 
WHERE ORDERS4.O_CUSTKEY = CUSTOMER2.C_CUSTKEY
AND ORDERS4.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 7 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER3, NATION NATION1, REGION REGION0 
WHERE CUSTOMER3.C_NATIONKEY = NATION1.N_NATIONKEY
AND CUSTOMER3.C_CUSTKEY = ORDERS0.O_CUSTKEY
AND NATION1.N_REGIONKEY = REGION0.R_REGIONKEY
AND CUSTOMER3.C_MKTSEGMENT = 'MACHINERY'
AND 'O' = ORDERS0.O_ORDERSTATUS
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS5 
WHERE ORDERS5.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS5.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS6, CUSTOMER CUSTOMER4 
WHERE ORDERS6.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS6.O_CUSTKEY = CUSTOMER4.C_CUSTKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM PART PART1 
WHERE PART1.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART1.P_MFGR = 'Manufacturer#4'
AND 6 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER5, LINEITEM LINEITEM2 
WHERE CUSTOMER5.C_CUSTKEY = ORDERS0.O_CUSTKEY
AND LINEITEM2.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM2.L_LINENUMBER = 7
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM3, CUSTOMER CUSTOMER6, NATION NATION2 
WHERE LINEITEM3.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND CUSTOMER6.C_NATIONKEY = NATION2.N_NATIONKEY
AND NATION2.N_REGIONKEY = 0
AND LINEITEM3.L_SHIPMODE = 'FOB'
AND CUSTOMER6.C_MKTSEGMENT = 'MACHINERY'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER7, PARTSUPP PARTSUPP1, PART PART2, SUPPLIER SUPPLIER0 
WHERE CUSTOMER7.C_CUSTKEY = ORDERS0.O_CUSTKEY
AND PARTSUPP1.PS_PARTKEY = PART2.P_PARTKEY
AND PARTSUPP1.PS_PARTKEY = LINEITEM0.L_PARTKEY
AND PARTSUPP1.PS_SUPPKEY = SUPPLIER0.S_SUPPKEY
AND PARTSUPP1.PS_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART2.P_MFGR = 'Manufacturer#4'
AND CUSTOMER7.C_MKTSEGMENT = 'MACHINERY'
AND 6 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM4, CUSTOMER CUSTOMER8 
WHERE LINEITEM4.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM4.L_RETURNFLAG = 'N'
AND LINEITEM4.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS7, LINEITEM LINEITEM5 
WHERE ORDERS7.O_ORDERKEY = LINEITEM5.L_ORDERKEY
AND LINEITEM5.L_RETURNFLAG = 'N'
AND LINEITEM5.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS8 
WHERE ORDERS8.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS8.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM PART PART3, PARTSUPP PARTSUPP2 
WHERE PART3.P_PARTKEY = PARTSUPP2.PS_PARTKEY
AND PART3.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PARTSUPP2.PS_SUPPKEY = LINEITEM0.L_SUPPKEY
AND PART3.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'DELIVER IN PERSON' = LINEITEM0.L_SHIPINSTRUCT
)
AND NOT EXISTS(SELECT *
FROM PART PART4, PARTSUPP PARTSUPP3 
WHERE PART4.P_PARTKEY = PARTSUPP3.PS_PARTKEY
AND PART4.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART4.P_CONTAINER = 'WRAP PKG'
AND PART4.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM6 
WHERE LINEITEM6.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM6.L_RETURNFLAG = 'N'
)
AND NOT EXISTS(SELECT *
FROM PART PART5 
WHERE PART5.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART5.P_CONTAINER = 'WRAP PKG'
AND PART5.P_BRAND = 'Brand#54'
AND 'N' = LINEITEM0.L_RETURNFLAG
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS9 
WHERE ORDERS9.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS9.O_ORDERPRIORITY = '2-HIGH'
AND 4 = LINEITEM0.L_LINENUMBER
)
AND NOT EXISTS(SELECT *
FROM LINEITEM LINEITEM7 
WHERE LINEITEM7.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM7.L_LINENUMBER = 7
)
AND NOT EXISTS(SELECT *
FROM PART PART6, PARTSUPP PARTSUPP4, ORDERS ORDERS10 
WHERE ORDERS10.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND PART6.P_PARTKEY = PARTSUPP4.PS_PARTKEY
AND PART6.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART6.P_CONTAINER = 'WRAP PKG'
AND PART6.P_MFGR = 'Manufacturer#5'
AND PART6.P_BRAND = 'Brand#54'
AND ORDERS10.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM PART PART7, ORDERS ORDERS11 
WHERE ORDERS11.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND PART7.P_PARTKEY = LINEITEM0.L_PARTKEY
AND PART7.P_CONTAINER = 'WRAP PKG'
AND PART7.P_MFGR = 'Manufacturer#5'
AND PART7.P_BRAND = 'Brand#54'
AND ORDERS11.O_ORDERPRIORITY = '4-NOT SPECIFIED'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS12, LINEITEM LINEITEM8, NATION NATION3 
WHERE ORDERS12.O_ORDERKEY = LINEITEM8.L_ORDERKEY
AND NATION3.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION3.N_REGIONKEY = 0
AND LINEITEM8.L_SHIPMODE = 'FOB'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS13, CUSTOMER CUSTOMER9 
WHERE ORDERS13.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
AND 'FOB' = LINEITEM0.L_SHIPMODE
)
AND NOT EXISTS(SELECT *
FROM NATION NATION4 
WHERE NATION4.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND NATION4.N_REGIONKEY = 0
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS14 
WHERE ORDERS14.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND ORDERS14.O_ORDERSTATUS = 'O'
)
AND NOT EXISTS(SELECT *
FROM CUSTOMER CUSTOMER10, LINEITEM LINEITEM9 
WHERE CUSTOMER10.C_CUSTKEY = ORDERS0.O_CUSTKEY
AND LINEITEM9.L_ORDERKEY = ORDERS0.O_ORDERKEY
AND LINEITEM9.L_RETURNFLAG = 'N'
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS15 
WHERE ORDERS15.O_ORDERKEY = ORDERS0.O_ORDERKEY
AND 'N' = LINEITEM0.L_RETURNFLAG
)

Executing the rewritten query results in -1 rows.

Planning: 
[0.0, 0.0, 0.0, 0.0, 0.0]
Execution: 
[0.0, 0.0, 0.0, 0.0, 0.0]



