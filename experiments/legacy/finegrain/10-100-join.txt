Query Q(muy,mux,muj,muz,mum,mvb,muw) :- NATION(mul,mum,mun,muo),ORDERS(muk,muj,mup,muq,mur,mus,mut,muu,muv),CUSTOMER(muj,muw,mux,mul,muy,muz,mva,mvb),LINEITEM(muk,mvc,mvd,mve,mvf,mvg,mvh,mvi,'R',mvj,mvk,mvl,mvm,mvn,mvo,mvp)

SELECT CUSTOMER0.C_PHONE, CUSTOMER0.C_ADDRESS, ORDERS0.O_CUSTKEY, CUSTOMER0.C_ACCTBAL, NATION0.N_NAME, CUSTOMER0.C_COMMENT, CUSTOMER0.C_NAME 
FROM NATION NATION0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, LINEITEM LINEITEM0 
WHERE ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND LINEITEM0.L_RETURNFLAG = 'R'


Parsing query took 248 miliseconds
Query touches 10363045 rows
Planning: 
[20.531, 17.616, 26.403, 25.536, 12.813]
Execution: 
[231422.66, 226809.1, 228174.02, 228600.72, 224413.47]

Running the query against 100 of the 500 joining constraint
Rewriting query with 100 of the 500 joining constraints took 15 miliseconds
For this query, rewriting with 100 of the 500 joining constraints produced 34 successful unifications.
SELECT CUSTOMER0.C_PHONE, CUSTOMER0.C_ADDRESS, ORDERS0.O_CUSTKEY, CUSTOMER0.C_ACCTBAL, NATION0.N_NAME, CUSTOMER0.C_COMMENT, CUSTOMER0.C_NAME 
FROM NATION NATION0, ORDERS ORDERS0, CUSTOMER CUSTOMER0, LINEITEM LINEITEM0 
WHERE ORDERS0.O_ORDERKEY = LINEITEM0.L_ORDERKEY
AND ORDERS0.O_CUSTKEY = CUSTOMER0.C_CUSTKEY
AND NATION0.N_NATIONKEY = CUSTOMER0.C_NATIONKEY
AND LINEITEM0.L_RETURNFLAG = 'R'
AND NOT EXISTS(SELECT *
FROM NATION NATION1 
WHERE NATION1.N_NATIONKEY = NATION0.N_NATIONKEY
AND 4246447 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION2 
WHERE NATION2.N_NATIONKEY = NATION0.N_NATIONKEY
AND 3014932 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION3 
WHERE NATION3.N_NATIONKEY = NATION0.N_NATIONKEY
AND 2461941 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION4 
WHERE NATION4.N_NATIONKEY = NATION0.N_NATIONKEY
AND 1513330 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS1 
WHERE ORDERS1.O_ORDERPRIORITY = '5-LOW'
AND ORDERS1.O_CUSTKEY = 4720466
AND 4720466 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS2 
WHERE ORDERS2.O_CUSTKEY = 3349384
AND ORDERS2.O_ORDERPRIORITY = '3-MEDIUM'
AND ORDERS2.O_ORDERSTATUS = 'O'
AND 3349384 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION5 
WHERE NATION5.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION5.N_REGIONKEY = 4
AND 329838 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS3 
WHERE ORDERS3.O_CUSTKEY = 1635757
AND ORDERS3.O_ORDERSTATUS = 'O'
AND 1635757 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION6 
WHERE NATION6.N_NATIONKEY = NATION0.N_NATIONKEY
AND 3635885 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS4 
WHERE ORDERS4.O_ORDERPRIORITY = '2-HIGH'
AND ORDERS4.O_CUSTKEY = 840630
AND 840630 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS5 
WHERE ORDERS5.O_CUSTKEY = 1668201
AND ORDERS5.O_ORDERSTATUS = 'O'
AND 1668201 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION7 
WHERE NATION7.N_NATIONKEY = NATION0.N_NATIONKEY
AND 2046688 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION8 
WHERE NATION8.N_NATIONKEY = NATION0.N_NATIONKEY
AND 2215862 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION9 
WHERE NATION9.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION9.N_REGIONKEY = 2
AND 366680 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS6 
WHERE ORDERS6.O_ORDERPRIORITY = '5-LOW'
AND ORDERS6.O_ORDERSTATUS = 'F'
AND ORDERS6.O_CUSTKEY = 1088156
AND 1088156 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION10 
WHERE NATION10.N_NATIONKEY = NATION0.N_NATIONKEY
AND 4200582 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION11 
WHERE NATION11.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION11.N_REGIONKEY = 1
AND 4137000 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS7 
WHERE ORDERS7.O_ORDERPRIORITY = '3-MEDIUM'
AND ORDERS7.O_CUSTKEY = 390712
AND 390712 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION12 
WHERE NATION12.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION12.N_REGIONKEY = 4
AND 1019730 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION13 
WHERE NATION13.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION13.N_REGIONKEY = 4
AND 3476188 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS8 
WHERE ORDERS8.O_CUSTKEY = 3063421
AND 3063421 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS9 
WHERE ORDERS9.O_CUSTKEY = 4652053
AND ORDERS9.O_ORDERSTATUS = 'F'
AND 4652053 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS10 
WHERE ORDERS10.O_CUSTKEY = 3493829
AND 3493829 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION14 
WHERE NATION14.N_NATIONKEY = NATION0.N_NATIONKEY
AND 3895111 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION15 
WHERE NATION15.N_NATIONKEY = NATION0.N_NATIONKEY
AND 4642352 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS11 
WHERE ORDERS11.O_ORDERPRIORITY = '1-URGENT'
AND ORDERS11.O_CUSTKEY = 2816645
AND ORDERS11.O_ORDERSTATUS = 'O'
AND 2816645 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS12 
WHERE ORDERS12.O_CUSTKEY = 264643
AND ORDERS12.O_ORDERPRIORITY = '4-NOT SPECIFIED'
AND 264643 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS13 
WHERE ORDERS13.O_CUSTKEY = 723242
AND ORDERS13.O_ORDERSTATUS = 'P'
AND 723242 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS14 
WHERE ORDERS14.O_CUSTKEY = 2824393
AND ORDERS14.O_ORDERPRIORITY = '2-HIGH'
AND 2824393 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION16 
WHERE NATION16.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION16.N_REGIONKEY = 3
AND 4218138 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION17 
WHERE NATION17.N_NATIONKEY = NATION0.N_NATIONKEY
AND 3663922 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS15 
WHERE ORDERS15.O_CUSTKEY = 1043658
AND ORDERS15.O_ORDERPRIORITY = '1-URGENT'
AND ORDERS15.O_ORDERSTATUS = 'F'
AND 1043658 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM NATION NATION18 
WHERE NATION18.N_NATIONKEY = NATION0.N_NATIONKEY
AND NATION18.N_REGIONKEY = 4
AND 1907121 = ORDERS0.O_CUSTKEY
)
AND NOT EXISTS(SELECT *
FROM ORDERS ORDERS16 
WHERE ORDERS16.O_ORDERPRIORITY = '3-MEDIUM'
AND ORDERS16.O_CUSTKEY = 1753996
AND ORDERS16.O_ORDERSTATUS = 'P'
AND 1753996 = ORDERS0.O_CUSTKEY
)

Executing the rewritten 100 of the 500 joining query results in 10362999 rows.

Planning: 
[54.173, 52.239, 47.192, 43.847, 50.114]
Execution: 
[365356.5, 366314.72, 366052.8, 366343.62, 361422.34]



